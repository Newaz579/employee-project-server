<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Employee Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  <body id="updatePage">
    <form class="row g-3 col-10 m-auto" id="employeeForm">
        <h3>Give Information to Update an Employee</h3>
        <div class="row">
            <div class="col-8">
                <label for="name" class="form-label" >Name</label>
                <input type="text" class="form-control" id="name" name="name" placeholder="Name">
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-6">
                <label for="age" class="form-label">Age</label>
                <input type="text" class="form-control" id="age" name="age" placeholder="Age">
            </div>
        </div>
        <div class="row col-6 mt-3">
            <label for="gender" class="form-label">Gender</label>
            <select class="form-control ms-2" id="gender" name="gender">
                <option value="Male">Male</option>
                <option value="Female">Female</option>
            </select>
        </div>

        <div class="row mt-3">
            <div class="col-md-6">
                <label for="inputEmail4" class="form-label">Birthdate</label>
                <input type="date" class="form-control" id="birthdate" name="birthdate">
              </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-6">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" name="email">
              </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-6">
                <label for="contactNo" class="form-label">Contact Number</label>
                <input type="text" class="form-control" id="contactNo" name="contactNo">
            </div>
            <div class="col-md-6">
                <label for="emergencyContactNo" class="form-label">Emergency Contact Number</label>
                <input type="text" class="form-control" id="emergencyContactNo" name="emergencyContactNo">
            </div>
        </div>
        <div class="row col-6 mt-3">
            <label for="bloodGroup" class="form-label">Blood Group</label>
            <select class="form-control ms-2" id="bloodGroup" name="bloodGroup">
                <option value="A+">A+</option>
                <option value="A-">A-</option>
                <option value="B+">B+</option>
                <option value="B-">B-</option>
                <option value="AB+">AB+</option>
                <option value="AB-">AB-</option>
                <option value="O+">O+</option>
                <option value="O-">O-</option>
            </select>
        </div>
        <div class="row mt-3">
            <div class="col-6">
                <label for="presentAddress" class="form-label">Present Address</label>
                <input type="text" class="form-control" id="presentAddress" name="permanentAddress" placeholder="1234 Main St">
            </div>
            <div class="col-6">
                <label for="presentAddress" class="form-label">Parmanent Address</label>
                <input type="text" class="form-control" id="permanentAddress" name="presentAddress" placeholder="Apartment, studio, or floor">
            </div>
        </div>
        <div class="row col-6 mt-3">
            <label for="department" class="form-label">Department</label>
            <select class="form-control ms-2" id="department" name="department">
                <option value="">Leave blank to keep current department</option>
                <option value="Software Development">Software Development</option>
                <option value="HR">HR</option>
                <option value="Sales">Sales</option>
                <option value="Admin">Admin</option>
            </select>
        </div>
        
        <div class="row mt-5">
          <button onclick="updateEmployee()" class="btn btn-primary col-4 m-auto mb-5" >Update Employee</button>
        </div>
    </form>


    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
        }
        function getSingleEmployee(id){
            fetch(`http://localhost:5000/getsingle-employee/${id}`)
            .then(response => response.json())
            .then(data => {
                insertValue(data);
            })
            .catch(error => console.error('error', error));
            console.log(id);
        };
        function insertValue(singleEmployee){
            // console.log(singleEmployee);
            const name = document.getElementById('name');
            name.value = singleEmployee.name;
            const age = document.getElementById('age');
            age.value = singleEmployee.age;
            const gender = document.getElementById('gender');
            gender.value = singleEmployee.gender;
            const birthdate = document.getElementById('birthdate');
            birthdate.value = singleEmployee.birthdate;
            const email = document.getElementById('email');
            email.value = singleEmployee.email;
            const contactNo = document.getElementById('contactNo');
            contactNo.value = singleEmployee.contactNo;
            const emergencyContactNo = document.getElementById('emergencyContactNo');
            emergencyContactNo.value = singleEmployee.emergencyContactNo;
            const bloodGroup = document.getElementById('bloodGroup');
            bloodGroup.value = singleEmployee.bloodGroup;
            const presentAddress = document.getElementById('presentAddress');
            presentAddress.value = singleEmployee.presentAddress;

            const permanentAddress = document.getElementById('permanentAddress');
            permanentAddress.value = singleEmployee.permanentAddress
            const department = document.getElementById('department');
            department.value = singleEmployee.department;
        }
        document.addEventListener('DOMContentLoaded', function(){
            const id = getQueryParam('id');
            getSingleEmployee(id);
        })

        function updateEmployee(){

const id = getQueryParam('id');
// console.log(id);

const newData = {};

const name = document.getElementById("name").value;
if (name) newData.name = name;

const age = document.getElementById("age").value;
if (age) newData.age = parseInt(age);

const gender = document.getElementById("gender").value;
if (gender) newData.gender = gender;

const birthdate = document.getElementById("birthdate").value;
if (birthdate) newData.birthdate = birthdate;

const email = document.getElementById("email").value;
if (email) newData.email = email;

const contactNo = document.getElementById("contactNo").value;
if (contactNo) newData.contactNo = contactNo;

const emergencyContactNo = document.getElementById("emergencyContactNo").value;
if (emergencyContactNo) newData.emergencyContactNo = emergencyContactNo;

const bloodGroup = document.getElementById("bloodGroup").value;
if (bloodGroup) newData.bloodGroup = bloodGroup;

const presentAddress = document.getElementById("presentAddress").value;
if (presentAddress) newData.presentAddress = presentAddress;

const permanentAddress = document.getElementById("permanentAddress").value;
if (permanentAddress) newData.permanentAddress = permanentAddress;

const department = document.getElementById("department").value;
if (department) newData.department = department;

fetch(`http://localhost:5000/update-employee/${id}`, {
    method: 'PUT',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(newData)
})
.then(response => response.text())
.then(data => console.log(data))
.catch(error => console.error('Error:', error));
}
    </script>
    <!-- <script src="../utils/employeeService.js"></script> -->
  </body>
</html>


